library(readxl)
library(rio)
library(magrittr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggExtra)
library(ggthemes)
library(rCharts)
library(htmlwidgets)
library(sunburstR)
library(treemap)
library(stringr)
library(grid)
library(gridExtra)
read.files <- function(sheet)
{
read_excel(data.file,sheet) %>%
mutate(school = sheet)
}
knowlegde.factor <- c("Factual", "Conceptual", "Procedural")
cog.process.factor <- c("Remember","Understand","Apply","Analyze","Evaluate","Create")
application.factor <- c("Knowledge in one disicpline","Apply in a discipline","Apply across disciplines","Real-world: predictable","Real-world: unpredictable")
data.dir <- "~/ownCloud/Projects/R/Projects/ONCAT/data/"
data.file <- paste0(data.dir,"calculus.xlsx")
sheets <- excel_sheets(data.file)
oncat.data <- lapply(sheets, read.files) %>%
set_names(., sheets) %>%
bind_rows() %>%
mutate_each(funs(factor),-school) %>%
mutate(type=ifelse(grepl("Seneca",school),"College","University"))
oncat.data$`Type of Knowledge` %<>%
gdata::reorder.factor(new.order=c(2,1,3))
levels(oncat.data$`Type of Knowledge`) <- c("Factual", "Conceptual", "Procedural")
levels(oncat.data$Innovation) <- c("IN1","IN2","IN3")
levels(oncat.data$Interdependence) <- c("ID1","ID2","ID3")
oncat.data$`Cognitive process` %<>%
factor(levels=c("Remember","Understand","Apply","Analyze","Evaluate","Create"))
library(ggsubplot)
oncat.data %>%
group_by(type, school) %>%
mutate_each(funs(as.numeric), -school, -type) %>%
# summarize_each(funs(mean), -school, -type) %>%
gather(variable,value,-school,-type,-Application,-`Cognitive process`) %>%
group_by(type, variable, value) %>%
tally %>%
#   group_by(variable,value) %>%
#   tally %>%
mutate(value = factor(value, levels=c(1,2,3))) %>%
# mutate(freq = n/sum(n)*100) %>%
arrange(value) %>%
{
ggplot(.,aes(x = variable)) +
geom_bar(data = subset(., value==1),
aes(fill = variable), colour = "#FFFFF3", width = 1, position = "stack"
) +
geom_bar(data = subset(., value==2),
aes(fill = variable), colour = "#FFFFF3", width = 1,  position = "stack"
) +
geom_bar(data = subset(., value==3),
aes(fill = variable), colour = "#FFFFF3", width = 1,  position = "stack"
) +
coord_polar(theta = "x", start = 1)  +
facet_wrap(~type)
}
ggplot(casualties) +
geom_coxcomb(aes(angle = month, fill = month))
install.packages("ggplot2")
detach("package:ggplot2", unload=TRUE)
library("ggsubplot", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
detach("package:ggsubplot", unload=TRUE)
